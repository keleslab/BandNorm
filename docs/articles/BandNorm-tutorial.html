<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BandNorm-tutorial • BandNorm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BandNorm-tutorial">
<meta property="og:description" content="BandNorm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12345678-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12345678-0');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BandNorm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BandNorm-tutorial.html">BandNorm-tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="BandNorm-tutorial_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>BandNorm-tutorial</h1>
            
      
      
      <div class="hidden name"><code>BandNorm-tutorial.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The advent of single-cell sequencing technologies in profiling 3D genome organization led to development of single-cell high-throughput chromatin conformation (scHi-C) assays. Data from these assays enhance our ability to study dynamic chromatin architecture and the impact of spatial genome interactions on cell regulation at an unprecedented resolution. At the individual cell resolution, heterogeneity driven by the stochastic nature of chromatin fiber, various nuclear processes, and unwanted variation due to sequencing depths and batch effects poses major analytical challenges for inferring single cell-level 3D genome organizations.</p>
<p>To explicitly capture chromatin conformation features and distinguish cells based on their 3D genome organizations, we develop a simple and fast band normalization approach, <code>BandNorm</code>. <code>BandNorm</code> first removes genomic distance bias within a cell, and sequencing depth normalizes between cells. Consequently, <code>BandNorm</code> adds back a common band-dependent contact decay profile for the contact matrices across cells. The former step is achieved by dividing the interaction frequencies of each band within a cell with the cell’s band mean. The latter step is implemented by multiplying each scaled band by the average band mean across cells.</p>
<div class="figure">
<img src="../figures/bandnorm_intro.png" alt=""><p class="caption">The introduction for BandNorm</p>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>To use <code>BandNorm</code>, the following packages are necessary:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ggplot2'</span>, <span class="st">'dplyr'</span>, <span class="st">'data.table'</span>, <span class="st">'Rtsne'</span>, <span class="st">'umap'</span><span class="op">)</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>

<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"immunogenomics/harmony"</span><span class="op">)</span></code></pre></div>
<p>BandNorm can be installed from Github:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">'sshen82/BandNorm'</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="format-of-input" class="section level2">
<h2 class="hasAnchor">
<a href="#format-of-input" class="anchor"></a>Format of input</h2>
<p>There are two possible ways to input the data:</p>
<ol style="list-style-type: decimal">
<li><p>A path containing all cells in the form of [chr1, binA, chr2, binB, count],</p></li>
<li><p>An R data.frame in the form of [chr1, binA, binB, count, diag, cell_name]. The column names should be c(“chrom”, “binA”, “binB”, “count”, “diag”, “cell”)</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BandNorm</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.0.3</span>
<span class="co">#&gt; Loading required package: dplyr</span>
<span class="co">#&gt; Warning: package 'dplyr' was built under R version 4.0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="co">#&gt; Loading required package: data.table</span>
<span class="co">#&gt; Warning: package 'data.table' was built under R version 4.0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'data.table'</span>
<span class="co">#&gt; The following objects are masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     between, first, last</span>
<span class="co">#&gt; Loading required package: Rtsne</span>
<span class="co">#&gt; Warning: package 'Rtsne' was built under R version 4.0.3</span>
<span class="co">#&gt; Loading required package: harmony</span>
<span class="co">#&gt; Loading required package: Rcpp</span>
<span class="co">#&gt; Warning: package 'Rcpp' was built under R version 4.0.3</span>
<span class="co">#&gt; Loading required package: umap</span>
<span class="co">#&gt; Warning: package 'umap' was built under R version 4.0.3</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">hic_df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">hic_df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;    chrom  binA  binB count  diag    cell</span>
<span class="co">#&gt; 1   chr1 0e+00 0e+00    38 0e+00 Astro_1</span>
<span class="co">#&gt; 2   chr1 0e+00 1e+06     1 1e+06 Astro_1</span>
<span class="co">#&gt; 3   chr1 1e+06 1e+06   105 0e+00 Astro_1</span>
<span class="co">#&gt; 4   chr1 1e+06 2e+06     1 1e+06 Astro_1</span>
<span class="co">#&gt; 5   chr1 2e+06 2e+06   116 0e+00 Astro_1</span>
<span class="co">#&gt; 6   chr1 2e+06 3e+06     2 1e+06 Astro_1</span>
<span class="co">#&gt; 7   chr1 3e+06 3e+06   133 0e+00 Astro_1</span>
<span class="co">#&gt; 8   chr1 3e+06 4e+06     1 1e+06 Astro_1</span>
<span class="co">#&gt; 9   chr1 4e+06 4e+06   112 0e+00 Astro_1</span>
<span class="co">#&gt; 10  chr1 3e+06 5e+06     1 2e+06 Astro_1</span></code></pre></div>
<p>For the example dataset, we also have batch information and cell-type information. Note that the cell_name in those external information should be consistent with the hic_df file.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">batch</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">cell_type</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">batch</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       cell_name  batch        </span>
<span class="co">#&gt;  [1,] "Astro_1"  "181218_21yr"</span>
<span class="co">#&gt;  [2,] "Astro_2"  "181218_21yr"</span>
<span class="co">#&gt;  [3,] "Astro_3"  "181218_21yr"</span>
<span class="co">#&gt;  [4,] "Astro_4"  "181218_21yr"</span>
<span class="co">#&gt;  [5,] "Astro_5"  "181218_21yr"</span>
<span class="co">#&gt;  [6,] "Astro_6"  "181218_21yr"</span>
<span class="co">#&gt;  [7,] "Astro_7"  "181218_21yr"</span>
<span class="co">#&gt;  [8,] "Astro_8"  "181218_21yr"</span>
<span class="co">#&gt;  [9,] "Astro_9"  "181218_21yr"</span>
<span class="co">#&gt; [10,] "Astro_10" "181218_21yr"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cell_type</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       cell_name  cluster</span>
<span class="co">#&gt;  [1,] "Astro_1"  "Astro"</span>
<span class="co">#&gt;  [2,] "Astro_2"  "Astro"</span>
<span class="co">#&gt;  [3,] "Astro_3"  "Astro"</span>
<span class="co">#&gt;  [4,] "Astro_4"  "Astro"</span>
<span class="co">#&gt;  [5,] "Astro_5"  "Astro"</span>
<span class="co">#&gt;  [6,] "Astro_6"  "Astro"</span>
<span class="co">#&gt;  [7,] "Astro_7"  "Astro"</span>
<span class="co">#&gt;  [8,] "Astro_8"  "Astro"</span>
<span class="co">#&gt;  [9,] "Astro_9"  "Astro"</span>
<span class="co">#&gt; [10,] "Astro_10" "Astro"</span></code></pre></div>
</div>
<div id="download-existing-single-cell-hi-c-data" class="section level2">
<h2 class="hasAnchor">
<a href="#download-existing-single-cell-hi-c-data" class="anchor"></a>Download existing single-cell Hi-C data</h2>
<p>You can also use <code>download_schic</code> function to download real data. The available data includes Kim2020, Li2019, Ramani2017, and Lee2019. You can specify one of the cell-types in those cell lines. There are also summary files available for them, and the summary includes batch, cell-type, depth and sparsity information. You can go to <a href="http://pages.stat.wisc.edu/~sshen82/bandnorm/">this website</a> for more information.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/download_schic.html">download_schic</a></span><span class="op">(</span><span class="st">"Li2019"</span>, cell_type <span class="op">=</span> <span class="st">"2i"</span>, cell_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, summary_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="use-bandnorm" class="section level2">
<h2 class="hasAnchor">
<a href="#use-bandnorm" class="anchor"></a>Use BandNorm</h2>
<p>After obtaining the hic_df file, you can use the <code>bandnorm</code> function to normalize the data. The result consists of 6 columns: chromosome, binA, binB, diag (which is binB - binA), cell (which is the name of the cell), and BandNorm. You can use the save option to save the normalized file, and if so, you need to give a path for output.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bandnorm_result</span> <span class="op">=</span> <span class="fu"><a href="../reference/bandnorm.html">bandnorm</a></span><span class="op">(</span>hic_df <span class="op">=</span> <span class="va">hic_df</span>, save <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">bandnorm_result</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>
<span class="co">#&gt;    chrom  binA  binB  diag    cell   BandNorm</span>
<span class="co">#&gt; 1   chr1 0e+00 0e+00 0e+00 Astro_1  38.000000</span>
<span class="co">#&gt; 2   chr1 0e+00 1e+06 1e+06 Astro_1   8.051104</span>
<span class="co">#&gt; 3   chr1 1e+06 1e+06 0e+00 Astro_1 105.000000</span>
<span class="co">#&gt; 4   chr1 1e+06 2e+06 1e+06 Astro_1   8.051104</span>
<span class="co">#&gt; 5   chr1 2e+06 2e+06 0e+00 Astro_1 116.000000</span>
<span class="co">#&gt; 6   chr1 2e+06 3e+06 1e+06 Astro_1  16.102209</span>
<span class="co">#&gt; 7   chr1 3e+06 3e+06 0e+00 Astro_1 133.000000</span>
<span class="co">#&gt; 8   chr1 3e+06 4e+06 1e+06 Astro_1   8.051104</span>
<span class="co">#&gt; 9   chr1 4e+06 4e+06 0e+00 Astro_1 112.000000</span>
<span class="co">#&gt; 10  chr1 3e+06 5e+06 2e+06 Astro_1   8.392744</span>
<span class="co"># bandnorm_result = bandnorm(hic_df = hic_df, save = TRUE, save_path = getwd())</span></code></pre></div>
<p>Then, you can use <code>create_embedding</code> function to obtain a PCA embedding for the data. You can choose to use Harmony to remove the batch effect.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">embedding</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_embedding.html">create_embedding</a></span><span class="op">(</span>hic_df <span class="op">=</span> <span class="va">bandnorm_result</span>, do_harmony <span class="op">=</span> <span class="cn">TRUE</span>, batch <span class="op">=</span> <span class="va">batch</span><span class="op">)</span>
<span class="co">#&gt; Harmony 1/10</span>
<span class="co">#&gt; Harmony 2/10</span>
<span class="co">#&gt; Harmony 3/10</span>
<span class="co">#&gt; Harmony 4/10</span>
<span class="co">#&gt; Harmony 5/10</span>
<span class="co">#&gt; Harmony 6/10</span>
<span class="co">#&gt; Harmony converged after 6 iterations</span>
<span class="va">embedding</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>
<span class="co">#&gt;                 PC1       PC2        PC3         PC4        PC5        PC6</span>
<span class="co">#&gt; Astro_1  -25.045580 28.340756 -21.503128  31.0830161 -31.426508 -21.110937</span>
<span class="co">#&gt; Astro_2   -8.737207 37.697510  -4.612044   0.4379436  -5.695395  10.971344</span>
<span class="co">#&gt; Astro_3   -2.872590 10.491469  -0.653415   1.4019305  13.280892 -17.350215</span>
<span class="co">#&gt; Astro_4   -8.486334 26.923820 -24.821406  11.7428537 -12.637595 -19.125857</span>
<span class="co">#&gt; Astro_5    5.342918  9.114805 -20.621120   7.1481739 -16.750856 -18.269476</span>
<span class="co">#&gt; Astro_6  -19.391277 15.884357 -20.903456  -0.3520621  -6.030601   8.151918</span>
<span class="co">#&gt; Astro_7  -18.804863 32.364749 -34.980637 -22.5272592  -6.538678  -6.092682</span>
<span class="co">#&gt; Astro_8   -4.322921 40.579979   0.698904   5.8352437  -5.722999  16.086922</span>
<span class="co">#&gt; Astro_9  -11.262473 10.142704 -17.599125   8.4894510  -3.445408   9.482180</span>
<span class="co">#&gt; Astro_10 -14.905449  6.289121 -13.784609   4.0025092 -26.566669  -9.470627</span>
<span class="co">#&gt;                  PC7          PC8       PC9        PC10      PC11       PC12</span>
<span class="co">#&gt; Astro_1   -0.2947265 -51.90572590 30.759025  -7.6406692 15.107119 -18.046903</span>
<span class="co">#&gt; Astro_2   -5.1040509  -4.04780072  5.844001  13.8592277 13.048715 -25.353116</span>
<span class="co">#&gt; Astro_3  -19.6338134  16.91153497 -2.364388   3.4319849 -0.887914  -2.018459</span>
<span class="co">#&gt; Astro_4   10.1164111   0.38764603  5.282964 -14.0248802  1.319237 -12.598487</span>
<span class="co">#&gt; Astro_5    5.0991140   5.56836415 33.555164  15.7348945 78.410594 -36.959211</span>
<span class="co">#&gt; Astro_6  -10.0018656  -4.67029009  2.239397   0.7989765  8.407645 -42.150394</span>
<span class="co">#&gt; Astro_7   -2.4137538   0.08770806 -2.946273  -8.8777774  3.924052 -17.734656</span>
<span class="co">#&gt; Astro_8  -19.7133312  11.68369419 -2.701983   0.8079764 24.694397   1.756816</span>
<span class="co">#&gt; Astro_9   17.7425518  40.02529385 36.018890  11.9022163 27.660853 -70.624349</span>
<span class="co">#&gt; Astro_10  13.7074277  -4.37337473 33.242883 -17.2349082 13.827523 -28.070612</span>
<span class="co">#&gt;                PC13       PC14       PC15        PC16       PC17        PC18</span>
<span class="co">#&gt; Astro_1   39.081573 -21.026752  14.821431 -21.7094143  52.936198 -42.3640018</span>
<span class="co">#&gt; Astro_2   -1.217791   4.009529 -14.850985   6.2593446 -18.465407 -12.1946020</span>
<span class="co">#&gt; Astro_3   18.902403   7.848010  -4.605852   9.7357656  14.458027   0.1811033</span>
<span class="co">#&gt; Astro_4   -5.404832   8.603679 -17.635767  -0.8533168  -1.495510   0.7848221</span>
<span class="co">#&gt; Astro_5   22.852669  52.134343  -7.885745  22.0596837  -9.076908  23.8132379</span>
<span class="co">#&gt; Astro_6   25.422281   1.093848   5.195538 -13.5103136   1.463058 -12.3392181</span>
<span class="co">#&gt; Astro_7   19.644393  -3.078079  -4.671584   4.6118908  13.020849 -24.4874652</span>
<span class="co">#&gt; Astro_8   -2.003471 -45.594234  -3.009360 -10.7393834 -11.524850  -3.4683165</span>
<span class="co">#&gt; Astro_9  -35.140731 -20.765786  19.462011  40.9221054 -21.034488 -41.0497826</span>
<span class="co">#&gt; Astro_10  15.295301 -22.388777 -11.386924   3.8476055  20.073543 -24.8578602</span>
<span class="co">#&gt;                 PC19        PC20         PC21       PC22        PC23       PC24</span>
<span class="co">#&gt; Astro_1   34.6933014  31.4524692 -167.8524090  72.558919  -8.9552739 -26.561646</span>
<span class="co">#&gt; Astro_2   -5.6493979  -2.8899149    8.9759578 -10.952132 -21.4982901  19.687292</span>
<span class="co">#&gt; Astro_3   31.5373840  14.4608897   -3.0532662  10.818935 -22.0022965  10.477746</span>
<span class="co">#&gt; Astro_4   -4.0252417  18.9684257    9.9933101  -6.579484 -15.0517545 -22.770390</span>
<span class="co">#&gt; Astro_5  106.9153339  20.7039988  108.9241364   5.762381 121.3405809 -93.664069</span>
<span class="co">#&gt; Astro_6  -16.7954168  -5.4802647    0.5237965  47.991289  -2.6146729   6.919639</span>
<span class="co">#&gt; Astro_7   -9.6129843   0.9562933   -5.3100874  15.955457 -27.6401805  -2.748349</span>
<span class="co">#&gt; Astro_8   -1.2169749 -18.9501090  -37.0303805 -24.949317 -24.8467075  28.598523</span>
<span class="co">#&gt; Astro_9  -99.2474223 -57.5230919   27.8338753 -63.463938  41.0507088  17.472996</span>
<span class="co">#&gt; Astro_10  -0.9634045 -10.0135254   -4.8206727 -21.172528   0.8004012  -1.654024</span>
<span class="co">#&gt;                 PC25        PC26       PC27        PC28       PC29        PC30</span>
<span class="co">#&gt; Astro_1    6.8768410  -59.295541  26.010953 -157.487927  16.296475 -37.7158129</span>
<span class="co">#&gt; Astro_2  -12.1328755   19.923863   1.901399   -3.853591  -1.035433  15.3434511</span>
<span class="co">#&gt; Astro_3    2.8432219   28.589053 -27.684126   10.773470  38.810095   6.4565183</span>
<span class="co">#&gt; Astro_4   -0.6701505    7.781491  26.402553   19.936786   4.054353 -13.3257747</span>
<span class="co">#&gt; Astro_5   40.8194019   72.115432 -56.297311   76.643487 -54.808834  16.4037795</span>
<span class="co">#&gt; Astro_6    5.9015744   -0.762178  34.369654   -8.108522  23.081005   2.1678795</span>
<span class="co">#&gt; Astro_7   30.8469981    5.531170  21.581536   10.658423  23.298914 -27.9488326</span>
<span class="co">#&gt; Astro_8    5.9810223   -2.187160 -30.817536   24.631338  13.751950 -41.8583327</span>
<span class="co">#&gt; Astro_9    6.7695064 -161.947836  -3.653350   78.381877 -12.350198  -5.3134459</span>
<span class="co">#&gt; Astro_10 -41.0466445   -2.103885  21.134516    5.042714  12.085478  -0.2448157</span>
<span class="co">#&gt;                PC31       PC32       PC33       PC34       PC35        PC36</span>
<span class="co">#&gt; Astro_1   11.970667 -63.559597  18.169098 -15.482446  64.688632 -66.7368893</span>
<span class="co">#&gt; Astro_2  -10.344685   9.976024  11.012815  19.846689 -11.707848  10.0693795</span>
<span class="co">#&gt; Astro_3    9.382212 -14.252097 -75.873777   1.194728  -2.244843   3.2366234</span>
<span class="co">#&gt; Astro_4  -20.918186  11.552477 -15.547393  10.347739   9.881804   9.2574625</span>
<span class="co">#&gt; Astro_5  -21.615833   9.016247   2.138338 -43.323550  60.805585  31.7411465</span>
<span class="co">#&gt; Astro_6   -7.685334  41.778464  10.400796  -7.130914  11.735749   0.9870975</span>
<span class="co">#&gt; Astro_7  -32.404348   3.261528 -36.815543   1.792954 -49.817703   5.4003078</span>
<span class="co">#&gt; Astro_8   11.399584  15.943314  45.199268 -21.000141  57.262780  35.2249375</span>
<span class="co">#&gt; Astro_9   54.719385  -7.913321   5.930568  -6.252110 -67.633310  -9.8178876</span>
<span class="co">#&gt; Astro_10 -43.971693  39.936488 -32.816472  20.956770   2.921438   4.5467999</span>
<span class="co">#&gt;                PC37       PC38       PC39       PC40       PC41         PC42</span>
<span class="co">#&gt; Astro_1   17.121660  -22.06407  56.014317  -6.829978  -5.879485  -2.78586743</span>
<span class="co">#&gt; Astro_2    8.479422   18.00015  10.545271   1.133822 -11.838896  22.56823169</span>
<span class="co">#&gt; Astro_3  -16.280164   55.57161  -1.264806 -26.770147   9.262115  -0.05562943</span>
<span class="co">#&gt; Astro_4  -25.759421  -22.85331  42.666122   4.323750 -38.663604 -13.21005794</span>
<span class="co">#&gt; Astro_5   -5.069230  -41.51107  25.057987 -40.863156  73.326294   3.97064659</span>
<span class="co">#&gt; Astro_6  -13.496505   37.95202  49.567769  35.620957  -3.719731  30.58937609</span>
<span class="co">#&gt; Astro_7  -19.115292   31.01325 -38.308703   6.679716  30.601737 -41.90069178</span>
<span class="co">#&gt; Astro_8   35.249248 -109.56727  14.141909  -9.596247   3.286258 -18.91166397</span>
<span class="co">#&gt; Astro_9   10.703149   63.52662 -67.555765  28.710768 -12.730683  14.26746600</span>
<span class="co">#&gt; Astro_10  14.703183  -24.28823 -44.505894 -69.213677 -26.600500  21.82600738</span>
<span class="co">#&gt;                 PC43       PC44      PC45       PC46       PC47       PC48</span>
<span class="co">#&gt; Astro_1   -3.6705886 -12.447164  25.85473   7.023553 -20.379088  16.911540</span>
<span class="co">#&gt; Astro_2   39.2082614   0.888037 -14.33590 -26.249995  -2.745142 -13.991930</span>
<span class="co">#&gt; Astro_3    0.7965989  37.654061  33.80890  13.931868  57.096572  82.281084</span>
<span class="co">#&gt; Astro_4   26.3206386   1.346879  14.78662  49.980854  43.128491   0.649444</span>
<span class="co">#&gt; Astro_5  -15.4666907   4.136852 -19.85939 -10.868543 -45.637027  -6.010438</span>
<span class="co">#&gt; Astro_6  -30.8413260  10.027390 -52.94187   6.376088 -22.587819  13.246964</span>
<span class="co">#&gt; Astro_7   -5.9964957 -14.832215  17.45040 -67.305214  -6.512270  15.272147</span>
<span class="co">#&gt; Astro_8   40.2834106  33.380663 -54.57994  24.877108  26.052763 -38.519596</span>
<span class="co">#&gt; Astro_9  -16.8408403 -12.335510  24.05970  27.639502  39.348632 -57.430595</span>
<span class="co">#&gt; Astro_10  34.8866031  18.553180  13.05609  -6.245204 -29.123775 -19.809488</span>
<span class="co">#&gt;                PC49       PC50</span>
<span class="co">#&gt; Astro_1   29.374831 -18.053001</span>
<span class="co">#&gt; Astro_2  -22.660510  22.706532</span>
<span class="co">#&gt; Astro_3   -9.540926   3.822078</span>
<span class="co">#&gt; Astro_4   37.851263  36.229757</span>
<span class="co">#&gt; Astro_5  -16.678436   4.947284</span>
<span class="co">#&gt; Astro_6   -9.242431 -10.364903</span>
<span class="co">#&gt; Astro_7    8.848710  34.882525</span>
<span class="co">#&gt; Astro_8   16.435688  21.067974</span>
<span class="co">#&gt; Astro_9   38.004733  -8.371379</span>
<span class="co">#&gt; Astro_10 -59.030310 -81.518872</span></code></pre></div>
<p>Finally, using the embedding, you can use UMAP or tSNE to get a projection of all the cells on the 2D plane. If you have the cell-type information or batch information, it is possible to color them on the plot.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_embedding.html">plot_embedding</a></span><span class="op">(</span><span class="va">embedding</span>, <span class="st">"UMAP"</span>, cell_info <span class="op">=</span> <span class="va">cell_type</span>, label <span class="op">=</span> <span class="st">"Cell Type"</span><span class="op">)</span></code></pre></div>
<p><img src="BandNorm-tutorial_files/figure-html/plot_embedding-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_embedding.html">plot_embedding</a></span><span class="op">(</span><span class="va">embedding</span>, <span class="st">"UMAP"</span>, cell_info <span class="op">=</span> <span class="va">batch</span>, label <span class="op">=</span> <span class="st">"Batch"</span><span class="op">)</span></code></pre></div>
<p><img src="BandNorm-tutorial_files/figure-html/plot_embedding-2.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Siqi Shen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
