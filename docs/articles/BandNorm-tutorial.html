<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BandNorm-tutorial • BandNorm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BandNorm-tutorial">
<meta property="og:description" content="BandNorm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12345678-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12345678-0');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BandNorm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BandNorm-tutorial.html">BandNorm-tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="BandNorm-tutorial_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>BandNorm-tutorial</h1>
            
      
      
      <div class="hidden name"><code>BandNorm-tutorial.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The advent of single-cell sequencing technologies in profiling 3D genome organization led to development of single-cell high-throughput chromatin conformation (scHi-C) assays. Data from these assays enhance our ability to study dynamic chromatin architecture and the impact of spatial genome interactions on cell regulation at an unprecedented resolution. At the individual cell resolution, heterogeneity driven by the stochastic nature of chromatin fiber, various nuclear processes, and unwanted variation due to sequencing depths and batch effects poses major analytical challenges for inferring single cell-level 3D genome organizations.</p>
<p>To explicitly capture chromatin conformation features and distinguish cells based on their 3D genome organizations, we develop a simple and fast band normalization approach, <code>BandNorm</code>. <code>BandNorm</code> first removes genomic distance bias within a cell, and sequencing depth normalizes between cells. Consequently, <code>BandNorm</code> adds back a common band-dependent contact decay profile for the contact matrices across cells. The former step is achieved by dividing the interaction frequencies of each band within a cell with the cell’s band mean. The latter step is implemented by multiplying each scaled band by the average band mean across cells.</p>
<div class="figure">
<img src="../figures/bandnorm_intro.png" alt=""><p class="caption">The introduction for BandNorm</p>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>To use <code>BandNorm</code>, the following packages are necessary:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ggplot2'</span>, <span class="st">'dplyr'</span>, <span class="st">'data.table'</span>, <span class="st">'Rtsne'</span>, <span class="st">'umap'</span><span class="op">)</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>

<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"immunogenomics/harmony"</span><span class="op">)</span></code></pre></div>
<p>BandNorm can be installed from Github:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">'sshen82/BandNorm'</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Also, if the user doesn’t have default R path writing permission, it is possible to install the package to the personal library:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_libpaths.html">with_libpaths</a></span><span class="op">(</span><span class="st">"personalLibraryPath"</span>, <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"sshen82/BandNorm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="format-of-input" class="section level2">
<h2 class="hasAnchor">
<a href="#format-of-input" class="anchor"></a>Format of input</h2>
<p>There are two possible ways to input the data:</p>
<ol style="list-style-type: decimal">
<li>A path containing all cells in the form of [chr1, binA, chr2, binB, count], the cell looks like below:</li>
</ol>
<pre><code>chr1    0       chr1    1000000 9
chr1    1000000 chr1    1000000 200
chr1    0       chr1    2000000 2
chr1    1000000 chr1    2000000 4
chr1    2000000 chr1    2000000 220
chr1    1000000 chr1    3000000 1
chr1    2000000 chr1    3000000 11
chr1    3000000 chr1    3000000 197
chr1    1000000 chr1    4000000 1
chr1    2000000 chr1    4000000 2</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>An R data.frame in the form of [chr1, binA, binB, count, diag, cell_name]. The column names should be c(“chrom”, “binA”, “binB”, “count”, “diag”, “cell”). Below we print the example data.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BandNorm</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.0.3</span>
<span class="co">#&gt; Loading required package: dplyr</span>
<span class="co">#&gt; Warning: package 'dplyr' was built under R version 4.0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="co">#&gt; Loading required package: data.table</span>
<span class="co">#&gt; Warning: package 'data.table' was built under R version 4.0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'data.table'</span>
<span class="co">#&gt; The following objects are masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     between, first, last</span>
<span class="co">#&gt; Loading required package: Rtsne</span>
<span class="co">#&gt; Warning: package 'Rtsne' was built under R version 4.0.3</span>
<span class="co">#&gt; Loading required package: umap</span>
<span class="co">#&gt; Warning: package 'umap' was built under R version 4.0.3</span>
<span class="co">#&gt; Loading required package: progress</span>
<span class="co">#&gt; Warning: package 'progress' was built under R version 4.0.4</span>
<span class="co">#&gt; Loading required package: harmony</span>
<span class="co">#&gt; Loading required package: Rcpp</span>
<span class="co">#&gt; Warning: package 'Rcpp' was built under R version 4.0.3</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">hic_df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">hic_df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;    chrom  binA  binB count  diag    cell</span>
<span class="co">#&gt; 1   chr1 0e+00 0e+00    38 0e+00 Astro_1</span>
<span class="co">#&gt; 2   chr1 0e+00 1e+06     1 1e+06 Astro_1</span>
<span class="co">#&gt; 3   chr1 1e+06 1e+06   105 0e+00 Astro_1</span>
<span class="co">#&gt; 4   chr1 1e+06 2e+06     1 1e+06 Astro_1</span>
<span class="co">#&gt; 5   chr1 2e+06 2e+06   116 0e+00 Astro_1</span>
<span class="co">#&gt; 6   chr1 2e+06 3e+06     2 1e+06 Astro_1</span>
<span class="co">#&gt; 7   chr1 3e+06 3e+06   133 0e+00 Astro_1</span>
<span class="co">#&gt; 8   chr1 3e+06 4e+06     1 1e+06 Astro_1</span>
<span class="co">#&gt; 9   chr1 4e+06 4e+06   112 0e+00 Astro_1</span>
<span class="co">#&gt; 10  chr1 3e+06 5e+06     1 2e+06 Astro_1</span></code></pre></div>
<p>For the example dataset, we also have batch information and cell-type information. Note that the cell_name in those external information should be consistent with the hic_df file.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">batch</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">cell_type</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">batch</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       cell_name  batch        </span>
<span class="co">#&gt;  [1,] "Astro_1"  "181218_21yr"</span>
<span class="co">#&gt;  [2,] "Astro_2"  "181218_21yr"</span>
<span class="co">#&gt;  [3,] "Astro_3"  "181218_21yr"</span>
<span class="co">#&gt;  [4,] "Astro_4"  "181218_21yr"</span>
<span class="co">#&gt;  [5,] "Astro_5"  "181218_21yr"</span>
<span class="co">#&gt;  [6,] "Astro_6"  "181218_21yr"</span>
<span class="co">#&gt;  [7,] "Astro_7"  "181218_21yr"</span>
<span class="co">#&gt;  [8,] "Astro_8"  "181218_21yr"</span>
<span class="co">#&gt;  [9,] "Astro_9"  "181218_21yr"</span>
<span class="co">#&gt; [10,] "Astro_10" "181218_21yr"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cell_type</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       cell_name  cluster</span>
<span class="co">#&gt;  [1,] "Astro_1"  "Astro"</span>
<span class="co">#&gt;  [2,] "Astro_2"  "Astro"</span>
<span class="co">#&gt;  [3,] "Astro_3"  "Astro"</span>
<span class="co">#&gt;  [4,] "Astro_4"  "Astro"</span>
<span class="co">#&gt;  [5,] "Astro_5"  "Astro"</span>
<span class="co">#&gt;  [6,] "Astro_6"  "Astro"</span>
<span class="co">#&gt;  [7,] "Astro_7"  "Astro"</span>
<span class="co">#&gt;  [8,] "Astro_8"  "Astro"</span>
<span class="co">#&gt;  [9,] "Astro_9"  "Astro"</span>
<span class="co">#&gt; [10,] "Astro_10" "Astro"</span></code></pre></div>
</div>
<div id="download-existing-single-cell-hi-c-data" class="section level2">
<h2 class="hasAnchor">
<a href="#download-existing-single-cell-hi-c-data" class="anchor"></a>Download existing single-cell Hi-C data</h2>
<p>You can also use <code>download_schic</code> function to download real data. The available data includes <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008173">Kim2020</a>, <a href="https://www.nature.com/articles/s41592-019-0502-z">Li2019</a>, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5330809/">Ramani2017</a>, and <a href="https://www.nature.com/articles/s41592-019-0547-z">Lee2019</a>. You can specify one of the cell-types in those cell lines. There are also summary files available for them, and the summary includes batch, cell-type, depth and sparsity information. You can go to <a href="http://pages.stat.wisc.edu/~sshen82/bandnorm/">this website</a> for more information.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/download_schic.html">download_schic</a></span><span class="op">(</span><span class="st">"Li2019"</span>, cell_type <span class="op">=</span> <span class="st">"2i"</span>, cell_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, summary_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="use-bandnorm" class="section level2">
<h2 class="hasAnchor">
<a href="#use-bandnorm" class="anchor"></a>Use BandNorm</h2>
<p>We provide a demo scHi-C data named hic_df, sampled 400 cells of Astro, ODC, MG, Sst, four cell types and chromosome 1 from <a href="https://www.nature.com/articles/s41592-019-0547-z">Ecker2019</a> for test run. After obtaining the hic_df file, you can use the <code>bandnorm</code> function to normalize the data. The result consists of 6 columns: chromosome, binA, binB, diag (which is binB - binA), cell (which is the name of the cell), and BandNorm. You can use the save option to save the normalized file, and if so, you need to give a path for output.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bandnorm_result</span> <span class="op">=</span> <span class="fu"><a href="../reference/bandnorm.html">bandnorm</a></span><span class="op">(</span>hic_df <span class="op">=</span> <span class="va">hic_df</span>, save <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">bandnorm_result</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>
<span class="co">#&gt;    chrom  binA  binB  diag    cell   BandNorm</span>
<span class="co">#&gt; 1   chr1 0e+00 0e+00 0e+00 Astro_1  38.000000</span>
<span class="co">#&gt; 2   chr1 0e+00 1e+06 1e+06 Astro_1   8.051104</span>
<span class="co">#&gt; 3   chr1 1e+06 1e+06 0e+00 Astro_1 105.000000</span>
<span class="co">#&gt; 4   chr1 1e+06 2e+06 1e+06 Astro_1   8.051104</span>
<span class="co">#&gt; 5   chr1 2e+06 2e+06 0e+00 Astro_1 116.000000</span>
<span class="co">#&gt; 6   chr1 2e+06 3e+06 1e+06 Astro_1  16.102209</span>
<span class="co">#&gt; 7   chr1 3e+06 3e+06 0e+00 Astro_1 133.000000</span>
<span class="co">#&gt; 8   chr1 3e+06 4e+06 1e+06 Astro_1   8.051104</span>
<span class="co">#&gt; 9   chr1 4e+06 4e+06 0e+00 Astro_1 112.000000</span>
<span class="co">#&gt; 10  chr1 3e+06 5e+06 2e+06 Astro_1   8.392744</span>
<span class="co"># bandnorm_result = bandnorm(hic_df = hic_df, save = TRUE, save_path = getwd())</span></code></pre></div>
<p>Then, you can use <code>create_embedding</code> function to obtain a PCA embedding for the data. You can choose to use Harmony to remove the batch effect.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">embedding</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_embedding.html">create_embedding</a></span><span class="op">(</span>hic_df <span class="op">=</span> <span class="va">bandnorm_result</span>, do_harmony <span class="op">=</span> <span class="cn">TRUE</span>, batch <span class="op">=</span> <span class="va">batch</span><span class="op">)</span>
<span class="co">#&gt; Harmony 1/10</span>
<span class="co">#&gt; Harmony 2/10</span>
<span class="co">#&gt; Harmony 3/10</span>
<span class="co">#&gt; Harmony 4/10</span>
<span class="co">#&gt; Harmony 5/10</span>
<span class="co">#&gt; Harmony 6/10</span>
<span class="co">#&gt; Harmony 7/10</span>
<span class="co">#&gt; Harmony 8/10</span>
<span class="co">#&gt; Harmony 9/10</span>
<span class="co">#&gt; Harmony converged after 9 iterations</span>
<span class="va">embedding</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>
<span class="co">#&gt;                  PC1       PC2         PC3        PC4         PC5         PC6</span>
<span class="co">#&gt; Astro_1  -24.8327597 26.392573 -20.7891206 34.0947549 -37.6581739 -20.8473780</span>
<span class="co">#&gt; Astro_2  -10.1511718 32.635316   3.5410343 11.5781158  -6.1524393   4.9198975</span>
<span class="co">#&gt; Astro_3   -3.8736705  7.868317   0.1383700  5.1797074   3.4825478 -13.0621151</span>
<span class="co">#&gt; Astro_4   -9.0874986 27.674603 -25.0603608  9.7827199 -10.6934610 -14.3924111</span>
<span class="co">#&gt; Astro_5    5.7939948  7.281867 -20.0732565 10.2511262 -23.4066809 -18.3308765</span>
<span class="co">#&gt; Astro_6  -18.9156709 17.986718 -23.4100290  0.9670646  -4.1686843  14.1672033</span>
<span class="co">#&gt; Astro_7  -28.4795016 21.837615  -9.8288448  4.3664097  -0.1056411  -8.2645790</span>
<span class="co">#&gt; Astro_8   -0.1706595 42.313012   0.8087349  6.3979346  -1.8964387  17.8314744</span>
<span class="co">#&gt; Astro_9   -7.9629124  7.793612 -17.4283964 13.6775092  -8.9769421   0.4449869</span>
<span class="co">#&gt; Astro_10 -15.3915230  6.430847 -15.6842339  0.9698182 -22.0206705  -8.8752470</span>
<span class="co">#&gt;                 PC7        PC8          PC9       PC10      PC11       PC12</span>
<span class="co">#&gt; Astro_1    2.705054 -51.287897  38.14517033  -6.697810 22.749195 -23.206554</span>
<span class="co">#&gt; Astro_2   -8.153376  -9.379799   5.71430964  15.071981 18.404924 -17.890686</span>
<span class="co">#&gt; Astro_3  -14.737152  21.432245  -1.85447007   5.565041 -1.298024  -3.600643</span>
<span class="co">#&gt; Astro_4    9.178174   1.679892   1.54680332 -13.810005 -6.315821 -13.274863</span>
<span class="co">#&gt; Astro_5    8.047742   6.149407  41.36841892  16.745443 86.510333 -42.250992</span>
<span class="co">#&gt; Astro_6   -6.204899  -2.373878  -0.96054434   2.218262 11.121562 -52.153000</span>
<span class="co">#&gt; Astro_7   -6.318190  -1.715890 -10.08894259  -8.143314 -7.690864  -2.236567</span>
<span class="co">#&gt; Astro_8  -20.024758  12.277283   0.06159396   2.522247 23.996427   1.906261</span>
<span class="co">#&gt; Astro_9   16.562643  33.340115  41.42895860  13.809923 44.418685 -68.412207</span>
<span class="co">#&gt; Astro_10   7.058383  -7.757155  25.18611574 -16.964075  7.491673 -23.573705</span>
<span class="co">#&gt;                PC13       PC14       PC15       PC16       PC17       PC18</span>
<span class="co">#&gt; Astro_1   33.090794 -23.348158  27.164418 -18.849800  45.539950 -51.554565</span>
<span class="co">#&gt; Astro_2    6.021292   7.329358  -6.816724   3.302984 -15.562293  -8.932750</span>
<span class="co">#&gt; Astro_3   10.259615   3.094901   1.684024  11.863392   7.782570  -5.439043</span>
<span class="co">#&gt; Astro_4   -7.204206   5.763787 -17.892266  -6.260372  -4.097885   2.549266</span>
<span class="co">#&gt; Astro_5   16.840673  49.779081   5.055722  25.356843 -16.681020  14.287380</span>
<span class="co">#&gt; Astro_6   24.058406  -6.301790   1.384873 -18.849321  -1.834327 -13.168922</span>
<span class="co">#&gt; Astro_7   22.840797  -1.406267  -9.908438  -1.700659  14.422831 -16.281702</span>
<span class="co">#&gt; Astro_8   -1.492478 -48.440108  -3.722764 -20.862491  -8.384065   1.104557</span>
<span class="co">#&gt; Astro_9  -27.349602 -16.734112  35.452723  41.756585 -18.267772 -42.401481</span>
<span class="co">#&gt; Astro_10  24.995020 -22.463928 -10.412672  -6.920474  24.315493 -16.022613</span>
<span class="co">#&gt;                 PC19       PC20         PC21       PC22       PC23       PC24</span>
<span class="co">#&gt; Astro_1   23.6959221  22.857528 -166.7181247  63.143894   2.875145 -29.414990</span>
<span class="co">#&gt; Astro_2   15.3999110   6.893627    3.4933505  -1.580621  -9.939923   4.697664</span>
<span class="co">#&gt; Astro_3   16.6148174   7.471933    0.2621783   1.261450 -18.404312  14.035123</span>
<span class="co">#&gt; Astro_4  -19.2475048  13.547081   14.8379365  -9.770603 -30.169666  -5.552506</span>
<span class="co">#&gt; Astro_5   96.0117284  11.906230  109.9616687  -3.735611 134.063985 -97.320775</span>
<span class="co">#&gt; Astro_6  -23.5040495  -3.908570   -1.3099740  39.646144 -11.552194  19.062152</span>
<span class="co">#&gt; Astro_7    3.3070448   6.842171   -6.4426369  21.232891 -29.953467  -3.182678</span>
<span class="co">#&gt; Astro_8    0.5786564 -22.742215  -37.2187655 -21.792830 -27.999262  30.330180</span>
<span class="co">#&gt; Astro_9  -72.9349313 -46.430370   18.9396576 -53.969322  65.135687  -8.801856</span>
<span class="co">#&gt; Astro_10   3.4052702  -2.570082   -4.1963804 -11.052566 -15.645927   6.792399</span>
<span class="co">#&gt;                 PC25        PC26       PC27        PC28       PC29       PC30</span>
<span class="co">#&gt; Astro_1    8.8525924  -82.336202  27.073940 -146.990575  14.595598 -34.004940</span>
<span class="co">#&gt; Astro_2   -2.7190260   28.100638  -9.612493  -15.903054  -5.213705  15.630258</span>
<span class="co">#&gt; Astro_3    0.9052896   16.474351 -22.723565   17.767267  41.120826   8.748677</span>
<span class="co">#&gt; Astro_4   -5.1410623   11.108775  29.947278   19.719655  11.346145 -10.271948</span>
<span class="co">#&gt; Astro_5   43.0807942   48.268343 -55.439855   87.375914 -56.811123  20.022951</span>
<span class="co">#&gt; Astro_6    2.5114036   -9.569142  31.606849   -4.242452  30.989150   5.211285</span>
<span class="co">#&gt; Astro_7   35.9164009   24.158848  19.958313    1.417747  19.639485 -23.973293</span>
<span class="co">#&gt; Astro_8    8.0275948   -3.521252 -31.064110   23.975833  13.612714 -40.475079</span>
<span class="co">#&gt; Astro_9   20.0020098 -165.274199 -20.640331   67.907631 -19.054114  -6.582496</span>
<span class="co">#&gt; Astro_10 -42.5401972   22.277245  13.796687  -12.262843  20.369670  -1.973774</span>
<span class="co">#&gt;                PC31       PC32        PC33       PC34       PC35       PC36</span>
<span class="co">#&gt; Astro_1   16.085533 -63.689360  18.4348668 -14.185288  57.390501 -73.594145</span>
<span class="co">#&gt; Astro_2   -2.433446  -7.087372   8.9048194   7.580844  -1.225864   1.773639</span>
<span class="co">#&gt; Astro_3    9.375508  -7.165880 -75.0001910   6.991758  -9.740246   1.659056</span>
<span class="co">#&gt; Astro_4  -24.803810  26.038257  -9.9987921  20.419560  10.827399  22.376704</span>
<span class="co">#&gt; Astro_5  -16.848561   8.396782   2.3643683 -42.007080  53.453504  24.410749</span>
<span class="co">#&gt; Astro_6  -27.355160  51.844282   9.9326933 -17.272698  15.553572   6.305021</span>
<span class="co">#&gt; Astro_7  -32.030328  -6.647170 -36.1455748  -4.092902 -53.491486  -2.553929</span>
<span class="co">#&gt; Astro_8   14.411627  17.105849  42.9289180 -21.693997  55.412021  36.383159</span>
<span class="co">#&gt; Astro_9   66.799096 -32.077544   0.8901514 -24.879864 -52.608353 -23.847511</span>
<span class="co">#&gt; Astro_10 -44.971456  46.623258 -28.1239804  24.498923  21.795848  23.917649</span>
<span class="co">#&gt;                PC37        PC38       PC39        PC40       PC41        PC42</span>
<span class="co">#&gt; Astro_1   14.233831  -10.163462  46.063304  -3.5006794  -6.972141   2.9188294</span>
<span class="co">#&gt; Astro_2    1.420124    8.282253  19.842860   0.7391835  -3.301588  20.8098471</span>
<span class="co">#&gt; Astro_3  -17.726498   62.843461  -9.411433 -22.5536305   6.242879   0.9654739</span>
<span class="co">#&gt; Astro_4  -26.630753  -22.667869  36.901834   9.1998642 -45.785857 -14.6888161</span>
<span class="co">#&gt; Astro_5   -8.205462  -29.050230  14.776194 -37.3250450  72.272276   9.9678119</span>
<span class="co">#&gt; Astro_6   -7.790579   28.273454  52.009497  27.8375777  -8.339924  30.7996055</span>
<span class="co">#&gt; Astro_7  -23.250454   26.078897 -27.136151   7.3741326  36.593616 -46.6275041</span>
<span class="co">#&gt; Astro_8   38.131131 -105.655980  14.386993  -9.4154917   7.406445 -14.5362733</span>
<span class="co">#&gt; Astro_9    3.258978   54.403271 -59.309211  26.2304126  -1.546226  15.9827541</span>
<span class="co">#&gt; Astro_10   7.251727  -43.543078 -39.692870 -65.1672578 -28.855960  14.3810476</span>
<span class="co">#&gt;                 PC43        PC44       PC45       PC46        PC47        PC48</span>
<span class="co">#&gt; Astro_1   -4.3876529 -11.9295671  29.344743   5.104129 -20.4132164   8.3713768</span>
<span class="co">#&gt; Astro_2   34.9278275   3.9680680 -14.850418 -23.319969   0.5732060  -0.7813476</span>
<span class="co">#&gt; Astro_3    0.2540971  38.2288156  34.369131  11.799283  56.6276807  75.0150937</span>
<span class="co">#&gt; Astro_4   23.7498116   2.0031794  12.708652  50.684204  34.6765917  -2.5297100</span>
<span class="co">#&gt; Astro_5  -16.4251566   4.9128773 -16.255568 -12.781267 -45.4520835 -14.5899051</span>
<span class="co">#&gt; Astro_6  -23.5391032  -0.7769934 -45.362980   2.532242 -36.2457005   3.5720191</span>
<span class="co">#&gt; Astro_7   -5.9136134 -15.5403004  12.641021 -70.278930   0.7249897  26.3205616</span>
<span class="co">#&gt; Astro_8   43.2853995  28.3769845 -53.798368  23.143023  26.1947813 -36.8210920</span>
<span class="co">#&gt; Astro_9  -21.1571600  -8.9613133  27.691530  31.613701  43.5548404 -45.2087671</span>
<span class="co">#&gt; Astro_10  24.6309353  24.2086794   8.453943   2.780061 -44.1849311  -6.8160222</span>
<span class="co">#&gt;                PC49        PC50</span>
<span class="co">#&gt; Astro_1   33.122852 -22.0423488</span>
<span class="co">#&gt; Astro_2  -14.686387  30.1193594</span>
<span class="co">#&gt; Astro_3   -9.177978   2.1457112</span>
<span class="co">#&gt; Astro_4   32.442451  31.5917702</span>
<span class="co">#&gt; Astro_5  -12.473749   0.9123622</span>
<span class="co">#&gt; Astro_6  -12.884320 -18.8619080</span>
<span class="co">#&gt; Astro_7    3.202117  46.8832058</span>
<span class="co">#&gt; Astro_8   19.313529  19.4176520</span>
<span class="co">#&gt; Astro_9   54.748468  -2.9582887</span>
<span class="co">#&gt; Astro_10 -61.926822 -81.8505600</span></code></pre></div>
<p>Finally, using the embedding, you can use UMAP or tSNE to get a projection of all the cells on the 2D plane. If you have the cell-type information or batch information, it is possible to color them on the plot.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_embedding.html">plot_embedding</a></span><span class="op">(</span><span class="va">embedding</span>, <span class="st">"UMAP"</span>, cell_info <span class="op">=</span> <span class="va">cell_type</span>, label <span class="op">=</span> <span class="st">"Cell Type"</span><span class="op">)</span></code></pre></div>
<p><img src="BandNorm-tutorial_files/figure-html/plot_embedding-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_embedding.html">plot_embedding</a></span><span class="op">(</span><span class="va">embedding</span>, <span class="st">"UMAP"</span>, cell_info <span class="op">=</span> <span class="va">batch</span>, label <span class="op">=</span> <span class="st">"Batch"</span><span class="op">)</span></code></pre></div>
<p><img src="BandNorm-tutorial_files/figure-html/plot_embedding-2.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Siqi Shen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
