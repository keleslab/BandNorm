<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BandNorm-tutorial • BandNorm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BandNorm-tutorial">
<meta property="og:description" content="BandNorm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12345678-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12345678-0');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BandNorm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BandNorm-tutorial.html">BandNorm-tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="BandNorm-tutorial_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>BandNorm-tutorial</h1>
            
      
      
      <div class="hidden name"><code>BandNorm-tutorial.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The advent of single-cell sequencing technologies in profiling 3D genome organization led to development of single-cell high-throughput chromatin conformation (scHi-C) assays. Data from these assays enhance our ability to study dynamic chromatin architecture and the impact of spatial genome interactions on cell regulation at an unprecedented resolution. At the individual cell resolution, heterogeneity driven by the stochastic nature of chromatin fiber, various nuclear processes, and unwanted variation due to sequencing depths and batch effects poses major analytical challenges for inferring single cell-level 3D genome organizations.</p>
<p>To explicitly capture chromatin conformation features and distinguish cells based on their 3D genome organizations, we develop a simple and fast band normalization approach, <code>BandNorm</code>. <code>BandNorm</code> first removes genomic distance bias within a cell, and sequencing depth normalizes between cells. Consequently, <code>BandNorm</code> adds back a common band-dependent contact decay profile for the contact matrices across cells. The former step is achieved by dividing the interaction frequencies of each band within a cell with the cell’s band mean. The latter step is implemented by multiplying each scaled band by the average band mean across cells.</p>
<div class="figure">
<img src="https://github.com/sshen82/BandNorm/blob/main/figures/bandnorm_intro.png" alt=""><p class="caption">The introduction for BandNorm</p>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>To use <code>BandNorm</code>, the following packages are necessary:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ggplot2'</span>, <span class="st">'dplyr'</span>, <span class="st">'data.table'</span>, <span class="st">'Rtsne'</span>, <span class="st">'umap'</span><span class="op">)</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>

<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"immunogenomics/harmony"</span><span class="op">)</span></code></pre></div>
<p>BandNorm can be installed from Github:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">'sshen82/BandNorm'</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="format-of-input" class="section level2">
<h2 class="hasAnchor">
<a href="#format-of-input" class="anchor"></a>Format of input</h2>
<p>There are two possible ways to input the data:</p>
<ol style="list-style-type: decimal">
<li><p>A path containing all cells in the form of [chr1, binA, chr2, binB, count],</p></li>
<li><p>An R data.frame in the form of [chr1, binA, binB, count, diag, cell_name]. The column names should be c(“chrom”, “binA”, “binB”, “count”, “diag”, “cell”)</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BandNorm</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.0.3</span>
<span class="co">#&gt; Loading required package: dplyr</span>
<span class="co">#&gt; Warning: package 'dplyr' was built under R version 4.0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="co">#&gt; Loading required package: data.table</span>
<span class="co">#&gt; Warning: package 'data.table' was built under R version 4.0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'data.table'</span>
<span class="co">#&gt; The following objects are masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     between, first, last</span>
<span class="co">#&gt; Loading required package: Rtsne</span>
<span class="co">#&gt; Warning: package 'Rtsne' was built under R version 4.0.3</span>
<span class="co">#&gt; Loading required package: harmony</span>
<span class="co">#&gt; Loading required package: Rcpp</span>
<span class="co">#&gt; Warning: package 'Rcpp' was built under R version 4.0.3</span>
<span class="co">#&gt; Loading required package: umap</span>
<span class="co">#&gt; Warning: package 'umap' was built under R version 4.0.3</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">hic_df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">hic_df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;    chrom  binA  binB count  diag    cell</span>
<span class="co">#&gt; 1   chr1 0e+00 0e+00    38 0e+00 Astro_1</span>
<span class="co">#&gt; 2   chr1 0e+00 1e+06     1 1e+06 Astro_1</span>
<span class="co">#&gt; 3   chr1 1e+06 1e+06   105 0e+00 Astro_1</span>
<span class="co">#&gt; 4   chr1 1e+06 2e+06     1 1e+06 Astro_1</span>
<span class="co">#&gt; 5   chr1 2e+06 2e+06   116 0e+00 Astro_1</span>
<span class="co">#&gt; 6   chr1 2e+06 3e+06     2 1e+06 Astro_1</span>
<span class="co">#&gt; 7   chr1 3e+06 3e+06   133 0e+00 Astro_1</span>
<span class="co">#&gt; 8   chr1 3e+06 4e+06     1 1e+06 Astro_1</span>
<span class="co">#&gt; 9   chr1 4e+06 4e+06   112 0e+00 Astro_1</span>
<span class="co">#&gt; 10  chr1 3e+06 5e+06     1 2e+06 Astro_1</span></code></pre></div>
<p>For the example dataset, we also have batch information and cell-type information. Note that the cell_name in those external information should be consistent with the hic_df file.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">batch</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">cell_type</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">batch</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       cell_name  batch        </span>
<span class="co">#&gt;  [1,] "Astro_1"  "181218_21yr"</span>
<span class="co">#&gt;  [2,] "Astro_2"  "181218_21yr"</span>
<span class="co">#&gt;  [3,] "Astro_3"  "181218_21yr"</span>
<span class="co">#&gt;  [4,] "Astro_4"  "181218_21yr"</span>
<span class="co">#&gt;  [5,] "Astro_5"  "181218_21yr"</span>
<span class="co">#&gt;  [6,] "Astro_6"  "181218_21yr"</span>
<span class="co">#&gt;  [7,] "Astro_7"  "181218_21yr"</span>
<span class="co">#&gt;  [8,] "Astro_8"  "181218_21yr"</span>
<span class="co">#&gt;  [9,] "Astro_9"  "181218_21yr"</span>
<span class="co">#&gt; [10,] "Astro_10" "181218_21yr"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cell_type</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       cell_name  cluster</span>
<span class="co">#&gt;  [1,] "Astro_1"  "Astro"</span>
<span class="co">#&gt;  [2,] "Astro_2"  "Astro"</span>
<span class="co">#&gt;  [3,] "Astro_3"  "Astro"</span>
<span class="co">#&gt;  [4,] "Astro_4"  "Astro"</span>
<span class="co">#&gt;  [5,] "Astro_5"  "Astro"</span>
<span class="co">#&gt;  [6,] "Astro_6"  "Astro"</span>
<span class="co">#&gt;  [7,] "Astro_7"  "Astro"</span>
<span class="co">#&gt;  [8,] "Astro_8"  "Astro"</span>
<span class="co">#&gt;  [9,] "Astro_9"  "Astro"</span>
<span class="co">#&gt; [10,] "Astro_10" "Astro"</span></code></pre></div>
</div>
<div id="download-existing-single-cell-hi-c-data" class="section level2">
<h2 class="hasAnchor">
<a href="#download-existing-single-cell-hi-c-data" class="anchor"></a>Download existing single-cell Hi-C data</h2>
<p>You can also use <code>download_schic</code> function to download real data. The available data includes Kim2020, Li2019, Ramani2017, and Lee2019. You can specify one of the cell-types in those cell lines. There are also summary files available for them, and the summary includes batch, cell-type, depth and sparsity information. You can go to <a href="http://pages.stat.wisc.edu/~sshen82/bandnorm/">this website</a> for more information.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/download_schic.html">download_schic</a></span><span class="op">(</span><span class="st">"Li2019"</span>, cell_type <span class="op">=</span> <span class="st">"2i"</span>, <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, summary_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="use-bandnorm" class="section level2">
<h2 class="hasAnchor">
<a href="#use-bandnorm" class="anchor"></a>Use BandNorm</h2>
<p>After obtaining the hic_df file, you can use the <code>bandnorm</code> function to normalize the data. The result consists of 6 columns: chromosome, binA, binB, diag (which is binB - binA), cell (which is the name of the cell), and BandNorm. You can use the save option to save the normalized file, and if so, you need to give a path for output.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bandnorm_result</span> <span class="op">=</span> <span class="fu"><a href="../reference/bandnorm.html">bandnorm</a></span><span class="op">(</span>hic_df <span class="op">=</span> <span class="va">hic_df</span>, save <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">bandnorm_result</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>
<span class="co">#&gt;    chrom  binA  binB  diag    cell   BandNorm</span>
<span class="co">#&gt; 1   chr1 0e+00 0e+00 0e+00 Astro_1  38.000000</span>
<span class="co">#&gt; 2   chr1 0e+00 1e+06 1e+06 Astro_1   8.051104</span>
<span class="co">#&gt; 3   chr1 1e+06 1e+06 0e+00 Astro_1 105.000000</span>
<span class="co">#&gt; 4   chr1 1e+06 2e+06 1e+06 Astro_1   8.051104</span>
<span class="co">#&gt; 5   chr1 2e+06 2e+06 0e+00 Astro_1 116.000000</span>
<span class="co">#&gt; 6   chr1 2e+06 3e+06 1e+06 Astro_1  16.102209</span>
<span class="co">#&gt; 7   chr1 3e+06 3e+06 0e+00 Astro_1 133.000000</span>
<span class="co">#&gt; 8   chr1 3e+06 4e+06 1e+06 Astro_1   8.051104</span>
<span class="co">#&gt; 9   chr1 4e+06 4e+06 0e+00 Astro_1 112.000000</span>
<span class="co">#&gt; 10  chr1 3e+06 5e+06 2e+06 Astro_1   8.392744</span>
<span class="co"># bandnorm_result = bandnorm(hic_df = hic_df, save = TRUE, save_path = getwd())</span></code></pre></div>
<p>Then, you can use <code>create_embedding</code> function to obtain a PCA embedding for the data. You can choose to use Harmony to remove the batch effect.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">embedding</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_embedding.html">create_embedding</a></span><span class="op">(</span>hic_df <span class="op">=</span> <span class="va">bandnorm_result</span>, do_harmony <span class="op">=</span> <span class="cn">TRUE</span>, batch <span class="op">=</span> <span class="va">batch</span><span class="op">)</span>
<span class="co">#&gt; Harmony 1/10</span>
<span class="co">#&gt; Harmony 2/10</span>
<span class="co">#&gt; Harmony 3/10</span>
<span class="co">#&gt; Harmony 4/10</span>
<span class="co">#&gt; Harmony 5/10</span>
<span class="co">#&gt; Harmony 6/10</span>
<span class="co">#&gt; Harmony 7/10</span>
<span class="co">#&gt; Harmony 8/10</span>
<span class="co">#&gt; Harmony 9/10</span>
<span class="co">#&gt; Harmony 10/10</span>
<span class="va">embedding</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>
<span class="co">#&gt;                 PC1       PC2         PC3        PC4         PC5         PC6</span>
<span class="co">#&gt; Astro_1  -10.407435 30.311847 -22.5629341 36.5584740 -33.7775736 -19.7304115</span>
<span class="co">#&gt; Astro_2  -13.948605 31.590074   1.9550869 11.3572545  -8.4321704   4.9477636</span>
<span class="co">#&gt; Astro_3    3.850206 19.358172  -0.7814799  7.0603435   7.6742081 -19.8494032</span>
<span class="co">#&gt; Astro_4   -4.248179 30.244316 -22.7363104 12.0623614  -8.2891452 -11.7871639</span>
<span class="co">#&gt; Astro_5   16.831371 23.511698 -22.6999337 15.1539468 -30.1817314 -22.5802352</span>
<span class="co">#&gt; Astro_6  -11.921279 19.773704 -23.8672011 -2.4116542  -0.5082911  16.2132904</span>
<span class="co">#&gt; Astro_7  -42.033822 25.723269 -13.3044557  8.6700649  -0.1687997  -3.7151454</span>
<span class="co">#&gt; Astro_8   -1.586775 43.724343  -1.0921870  9.2344368  -8.7732591  21.7068670</span>
<span class="co">#&gt; Astro_9  -11.795235  6.848824 -19.0584940 13.5161016 -11.2880546   0.4350785</span>
<span class="co">#&gt; Astro_10 -18.943309  5.827051 -17.3185268  0.9002096 -24.4671649  -8.7300854</span>
<span class="co">#&gt;                 PC7         PC8        PC9        PC10       PC11       PC12</span>
<span class="co">#&gt; Astro_1   -7.984585 -27.2850421 40.4898407 -12.4683371 36.8438925 -25.044087</span>
<span class="co">#&gt; Astro_2   -6.503074  -7.8691104  7.2866691  13.9309087 19.0944307 -19.202142</span>
<span class="co">#&gt; Astro_3  -39.924208  24.7410540  0.9181899  12.9421156  0.8667143  -6.059127</span>
<span class="co">#&gt; Astro_4    7.638606  -0.8670172  2.7685646 -13.3428641 -0.6404104  -9.717211</span>
<span class="co">#&gt; Astro_5  -15.019907   9.5324223 41.6853110  25.1984624 88.6412150 -43.550740</span>
<span class="co">#&gt; Astro_6  -21.791739  15.4348070 -1.7602423  -3.6669587  6.1314443 -45.014738</span>
<span class="co">#&gt; Astro_7   -5.706658   0.2117783 -1.2850604  -5.5594147  1.0744393  -5.489561</span>
<span class="co">#&gt; Astro_8  -17.027367  15.8467790 -3.8868170   0.8249291 23.6332668   2.192508</span>
<span class="co">#&gt; Astro_9   18.397323  34.6615322 43.1223835  12.7340965 45.2155622 -69.994032</span>
<span class="co">#&gt; Astro_10   8.415012  -6.0841057 26.8709603 -17.8697644  8.2184025 -25.241942</span>
<span class="co">#&gt;                 PC13       PC14       PC15         PC16       PC17         PC18</span>
<span class="co">#&gt; Astro_1   30.5488981 -19.832298  15.176035 -13.25026339  40.161046 -45.47063646</span>
<span class="co">#&gt; Astro_2    4.9677408   5.587344  -8.085136   3.32404525 -16.092850 -12.52978998</span>
<span class="co">#&gt; Astro_3   51.7936564 -51.657969   1.779110  19.63625195  25.945183   4.87117459</span>
<span class="co">#&gt; Astro_4    0.4748047   1.195655 -16.371041  -0.08746428  -1.723432   0.06318672</span>
<span class="co">#&gt; Astro_5   60.5717805  -6.264201   5.502505  34.47288292   2.883811  25.04615131</span>
<span class="co">#&gt; Astro_6   24.4257829  -4.156396  -5.240547 -17.76954476  -5.430265  -5.76173404</span>
<span class="co">#&gt; Astro_7   19.1868705  -4.808654  -4.623345   7.42484758   9.639565 -26.74954178</span>
<span class="co">#&gt; Astro_8  -11.4682059 -39.823213  -5.370269 -17.83848257 -11.588587  -4.03282857</span>
<span class="co">#&gt; Astro_9  -28.3989194 -18.652900  34.213099  41.82333618 -18.806150 -46.16748671</span>
<span class="co">#&gt; Astro_10  24.5609595 -25.625925 -11.710846  -6.57302100  23.963298 -19.61863059</span>
<span class="co">#&gt;                 PC19       PC20        PC21       PC22       PC23         PC24</span>
<span class="co">#&gt; Astro_1   36.5013237  29.133409 -147.773812  50.609524  13.231349  -33.0860364</span>
<span class="co">#&gt; Astro_2   14.9200266   6.947397    2.327617  -3.055540  -5.841683   -0.2818312</span>
<span class="co">#&gt; Astro_3   19.6474786  -2.737692  -11.826799   1.306606 -27.898431    7.8595833</span>
<span class="co">#&gt; Astro_4   -9.3782624  17.133785   12.714137  -4.094519 -17.599942  -18.6750124</span>
<span class="co">#&gt; Astro_5  101.6416496   2.492772   96.576474  -2.110720 127.350589 -106.5403808</span>
<span class="co">#&gt; Astro_6  -30.9790072  -8.962693   21.465825  34.144691 -18.986048   27.9645678</span>
<span class="co">#&gt; Astro_7   -7.2150170  -1.157107   -2.387419   3.988100 -16.752040   -4.9284042</span>
<span class="co">#&gt; Astro_8    0.5959278 -18.489105  -37.150922 -27.091748 -25.053135   32.3431211</span>
<span class="co">#&gt; Astro_9  -73.4315606 -46.428528   17.447132 -55.502309  69.319183  -13.8941311</span>
<span class="co">#&gt; Astro_10   2.3043005  -3.144017   -5.582785 -13.022125 -11.828100    2.0905639</span>
<span class="co">#&gt;                PC25        PC26       PC27         PC28       PC29       PC30</span>
<span class="co">#&gt; Astro_1   23.207378  -81.159700   3.123670 -125.4254549  17.713073 -25.593769</span>
<span class="co">#&gt; Astro_2   -3.116622   23.355518  -2.648275  -13.2722048  -7.868808  13.417807</span>
<span class="co">#&gt; Astro_3    1.656640    9.438377 -12.339236   -0.4184704  37.315106  -2.026420</span>
<span class="co">#&gt; Astro_4   -3.738251    7.251080  32.161266   16.0688188   7.518533 -17.882828</span>
<span class="co">#&gt; Astro_5   44.997384   41.156163 -47.255139   67.7878437 -61.334321   6.393949</span>
<span class="co">#&gt; Astro_6    6.690753    6.945147  25.033891    6.4540022  36.126717   9.251954</span>
<span class="co">#&gt; Astro_7   28.869555   -3.126754  18.954968    1.9971946  27.984911  -3.839576</span>
<span class="co">#&gt; Astro_8    8.913136   -2.769134 -34.613305   26.7575539  14.538132 -38.889568</span>
<span class="co">#&gt; Astro_9   19.511131 -170.566615 -13.506935   70.5928122 -21.789432  -8.884956</span>
<span class="co">#&gt; Astro_10 -43.131712   16.572358  21.168282   -9.5334469  17.743781  -4.281269</span>
<span class="co">#&gt;                PC31       PC32        PC33       PC34       PC35       PC36</span>
<span class="co">#&gt; Astro_1   -5.383494 -67.576841   6.3743140 -39.550991  54.539831 -75.806604</span>
<span class="co">#&gt; Astro_2   -5.437974  -5.560946   7.2253130   4.681776  -8.084604  -2.511906</span>
<span class="co">#&gt; Astro_3    6.488044 -16.510959 -63.7773656   8.697870  -2.357757  -3.707185</span>
<span class="co">#&gt; Astro_4  -19.772334  20.005601 -14.4534944  19.508707   8.556040  18.653533</span>
<span class="co">#&gt; Astro_5  -18.839240  -3.218899  13.8237105 -41.847143  63.205373  18.838661</span>
<span class="co">#&gt; Astro_6  -30.749348  62.880805  10.2614711  -8.060594  10.027033  21.973521</span>
<span class="co">#&gt; Astro_7  -26.568732  -4.932680 -34.7841550  11.110250 -37.200991  -3.865832</span>
<span class="co">#&gt; Astro_8   13.113556  12.528108  46.3345667 -19.689475  58.398732  32.150292</span>
<span class="co">#&gt; Astro_9   63.758573 -30.632289  -0.7665702 -27.907567 -59.547988 -28.387989</span>
<span class="co">#&gt; Astro_10 -48.263698  48.263217 -29.4797974  21.844788  14.799268  19.487630</span>
<span class="co">#&gt;                PC37       PC38       PC39         PC40        PC41        PC42</span>
<span class="co">#&gt; Astro_1   15.110015  -25.67943  46.191736 -16.01844352   0.8030685   0.1086415</span>
<span class="co">#&gt; Astro_2    1.751413   19.29063  18.690069  -0.03802042  -1.5217193  21.2954030</span>
<span class="co">#&gt; Astro_3  -12.468171   60.98753   4.130098 -16.80628562   2.7375825   6.1055902</span>
<span class="co">#&gt; Astro_4  -21.408046  -16.16389  35.796752  10.57829712 -30.8524622  -5.3818658</span>
<span class="co">#&gt; Astro_5   -2.722436  -31.13480  29.431386 -32.47532599  69.0937243  15.3722272</span>
<span class="co">#&gt; Astro_6  -16.497739   26.51677  40.982447  34.88948793  -9.1420158  24.8895694</span>
<span class="co">#&gt; Astro_7  -20.690291   40.92619 -18.277345  -3.38152271  42.8996969 -46.0275614</span>
<span class="co">#&gt; Astro_8   35.780793 -112.62101   9.558678 -11.66900554   4.5499990 -19.7870181</span>
<span class="co">#&gt; Astro_9    3.802184   65.64430 -60.402415  25.32931176   0.1461594  16.6543313</span>
<span class="co">#&gt; Astro_10   7.975291  -32.26963 -40.786766 -65.91429578 -27.4140996  15.1798189</span>
<span class="co">#&gt;                 PC43       PC44       PC45       PC46       PC47       PC48</span>
<span class="co">#&gt; Astro_1    5.5488747 -26.714494  36.433645 -11.976745 -22.316875  13.601321</span>
<span class="co">#&gt; Astro_2   37.0888790   1.085609 -14.583748 -28.227030   5.878683  -4.301332</span>
<span class="co">#&gt; Astro_3    2.6809894  30.331543  44.588833  15.288464  61.329497  75.227511</span>
<span class="co">#&gt; Astro_4   15.4519574   5.457485  13.498747  47.169380  18.607234   1.049149</span>
<span class="co">#&gt; Astro_5  -14.8900683  -2.875456  -5.206395  -8.957903 -41.718832 -12.705931</span>
<span class="co">#&gt; Astro_6  -30.4101576   1.667190 -51.692586  -2.742523 -40.377547  13.335687</span>
<span class="co">#&gt; Astro_7    0.2426729  -1.513273   8.713732 -54.865262  -4.436539  11.380089</span>
<span class="co">#&gt; Astro_8   42.6073107  35.239925 -55.877870  22.982268  25.530570 -41.663973</span>
<span class="co">#&gt; Astro_9  -18.8355441 -11.979938  28.146681  26.678965  48.872427 -49.040974</span>
<span class="co">#&gt; Astro_10  27.0800417  20.999465   9.128265  -2.130227 -38.973918 -10.926770</span>
<span class="co">#&gt;                PC49       PC50</span>
<span class="co">#&gt; Astro_1   33.307546 -16.978694</span>
<span class="co">#&gt; Astro_2  -14.891066  30.539209</span>
<span class="co">#&gt; Astro_3   -1.083900   2.550969</span>
<span class="co">#&gt; Astro_4   30.148419  27.081945</span>
<span class="co">#&gt; Astro_5   -2.363755   1.142385</span>
<span class="co">#&gt; Astro_6  -21.083738 -14.028228</span>
<span class="co">#&gt; Astro_7   -4.420042  29.066899</span>
<span class="co">#&gt; Astro_8   18.660856  23.568768</span>
<span class="co">#&gt; Astro_9   54.639109  -2.724113</span>
<span class="co">#&gt; Astro_10 -62.110004 -81.772631</span></code></pre></div>
<p>Finally, using the embedding, you can use UMAP or tSNE to get a projection of all the cells on the 2D plane. If you have the cell-type information, it is possible to color them on the plot.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_embedding.html">plot_embedding</a></span><span class="op">(</span><span class="va">embedding</span>, <span class="st">"UMAP"</span>, cell_type <span class="op">=</span> <span class="va">cell_type</span><span class="op">)</span></code></pre></div>
<p><img src="BandNorm-tutorial_files/figure-html/plot_embedding-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Siqi Shen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
